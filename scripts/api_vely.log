2025-05-22 14:18:49,449 - INFO - Modelo cargado correctamente desde: /home/evelym/Lab/VelyFirewall/scripts/models/7ef258d0e7dd4ef68d08688c4a903728_XGB_model.joblib
2025-05-22 14:18:49,450 - INFO - El modelo espera 45 características: [np.str_('f_c_ossn_others'), np.str_('f_same_cggt_is_gmlc_oc'), np.str_('f_same_cggt_is_gmlc_ossn'), np.str_('f_same_cggt_is_hlr_oc'), np.str_('f_same_cggt_is_hlr_ossn'), np.str_('f_count_ok_cl_between2lu'), np.str_('f_count_ok_psi_between2lu'), np.str_('f_velocity_greater_than_1000'), np.str_('f_count_unloop_country_last_x_hours_ul'), np.str_('f_count_gap_ok_sai_and_all_lu'), np.str_('f_count_ok_dsd_between2lu'), np.str_('f_count_ok_fwsm_mo_between2lu'), np.str_('f_count_ok_fwsm_mt_between2lu'), np.str_('f_count_ok_fwsm_report_between2lu'), np.str_('f_count_ok_fwsm_submit_between2lu'), np.str_('f_count_ok_isd_between2lu'), np.str_('f_count_ok_prn_between2lu'), np.str_('f_count_ok_purge_ms_between2lu'), np.str_('f_count_ok_sai_between2lu'), np.str_('f_count_ok_si_between2lu'), np.str_('f_count_ok_sri_between2lu'), np.str_('f_count_ok_srism_between2lu'), np.str_('f_count_ok_ul_between2lu'), np.str_('f_count_ok_ulgprs_between2lu'), np.str_('f_count_ok_ussd_between2lu'), np.str_('f_frequent_ok_cl_between2lu'), np.str_('f_frequent_ok_psi_between2lu'), np.str_('f_frequent_ok_dsd_between2lu'), np.str_('f_frequent_ok_fwsm_mo_between2lu'), np.str_('f_frequent_ok_fwsm_mt_between2lu'), np.str_('f_frequent_ok_fwsm_report_between2lu'), np.str_('f_frequent_ok_fwsm_submit_between2lu'), np.str_('f_frequent_ok_isd_between2lu'), np.str_('f_frequent_ok_prn_between2lu'), np.str_('f_frequent_ok_purge_ms_between2lu'), np.str_('f_frequent_ok_sai_between2lu'), np.str_('f_frequent_ok_si_between2lu'), np.str_('f_frequent_ok_sri_between2lu'), np.str_('f_frequent_ok_srism_between2lu'), np.str_('f_frequent_ok_ul_between2lu'), np.str_('f_frequent_ok_ulgprs_between2lu'), np.str_('f_frequent_ok_ussd_between2lu'), np.str_('f_ratio_cl_psi'), np.str_('f_high_activity_5min'), np.str_('f_one_cggt_multi_cdgt_psi')]
2025-05-22 14:20:22,198 - INFO - Modelo cargado correctamente desde: /home/evelym/Lab/VelyFirewall/scripts/models/7ef258d0e7dd4ef68d08688c4a903728_XGB_model.joblib
2025-05-22 14:20:22,198 - INFO - El modelo espera 45 características: [np.str_('f_c_ossn_others'), np.str_('f_same_cggt_is_gmlc_oc'), np.str_('f_same_cggt_is_gmlc_ossn'), np.str_('f_same_cggt_is_hlr_oc'), np.str_('f_same_cggt_is_hlr_ossn'), np.str_('f_count_ok_cl_between2lu'), np.str_('f_count_ok_psi_between2lu'), np.str_('f_velocity_greater_than_1000'), np.str_('f_count_unloop_country_last_x_hours_ul'), np.str_('f_count_gap_ok_sai_and_all_lu'), np.str_('f_count_ok_dsd_between2lu'), np.str_('f_count_ok_fwsm_mo_between2lu'), np.str_('f_count_ok_fwsm_mt_between2lu'), np.str_('f_count_ok_fwsm_report_between2lu'), np.str_('f_count_ok_fwsm_submit_between2lu'), np.str_('f_count_ok_isd_between2lu'), np.str_('f_count_ok_prn_between2lu'), np.str_('f_count_ok_purge_ms_between2lu'), np.str_('f_count_ok_sai_between2lu'), np.str_('f_count_ok_si_between2lu'), np.str_('f_count_ok_sri_between2lu'), np.str_('f_count_ok_srism_between2lu'), np.str_('f_count_ok_ul_between2lu'), np.str_('f_count_ok_ulgprs_between2lu'), np.str_('f_count_ok_ussd_between2lu'), np.str_('f_frequent_ok_cl_between2lu'), np.str_('f_frequent_ok_psi_between2lu'), np.str_('f_frequent_ok_dsd_between2lu'), np.str_('f_frequent_ok_fwsm_mo_between2lu'), np.str_('f_frequent_ok_fwsm_mt_between2lu'), np.str_('f_frequent_ok_fwsm_report_between2lu'), np.str_('f_frequent_ok_fwsm_submit_between2lu'), np.str_('f_frequent_ok_isd_between2lu'), np.str_('f_frequent_ok_prn_between2lu'), np.str_('f_frequent_ok_purge_ms_between2lu'), np.str_('f_frequent_ok_sai_between2lu'), np.str_('f_frequent_ok_si_between2lu'), np.str_('f_frequent_ok_sri_between2lu'), np.str_('f_frequent_ok_srism_between2lu'), np.str_('f_frequent_ok_ul_between2lu'), np.str_('f_frequent_ok_ulgprs_between2lu'), np.str_('f_frequent_ok_ussd_between2lu'), np.str_('f_ratio_cl_psi'), np.str_('f_high_activity_5min'), np.str_('f_one_cggt_multi_cdgt_psi')]
2025-05-22 14:22:50,983 - INFO - Procesando archivo: /home/evelym/Lab/VelyFirewall/logs/20250522_1422_ss7_traffic_20250522_142225.csv
2025-05-22 14:22:51,005 - INFO - Datos a procesar: {'src_ip': {19: '172.16.128.51'}, '_time': {19: '2025-05-22 14:22:42'}, 'c_timestamp': {19: '2025-05-22 14:22:42'}, 'c_cggt': {19: 'CGGT_4671'}, 'c_imsi': {19: 154035802721322}, 'f_c_ossn_others': {19: nan}, 'f_same_cggt_is_gmlc_oc': {19: 0}, 'f_same_cggt_is_gmlc_ossn': {19: 0}, 'f_same_cggt_is_hlr_oc': {19: 0}, 'f_same_cggt_is_hlr_ossn': {19: 0}, 'f_count_ok_cl_between2lu': {19: 3}, 'f_count_ok_psi_between2lu': {19: 3}, 'f_velocity_greater_than_1000': {19: 0}, 'f_count_unloop_country_last_x_hours_ul': {19: nan}, 'f_count_gap_ok_sai_and_all_lu': {19: nan}, 'f_count_ok_dsd_between2lu': {19: 2}, 'f_count_ok_fwsm_mo_between2lu': {19: 3}, 'f_count_ok_fwsm_mt_between2lu': {19: 1}, 'f_count_ok_fwsm_report_between2lu': {19: 2}, 'f_count_ok_fwsm_submit_between2lu': {19: 5}, 'f_count_ok_isd_between2lu': {19: 1}, 'f_count_ok_prn_between2lu': {19: 4}, 'f_count_ok_purge_ms_between2lu': {19: 5}, 'f_count_ok_sai_between2lu': {19: 0}, 'f_count_ok_si_between2lu': {19: 2}, 'f_count_ok_sri_between2lu': {19: 3}, 'f_count_ok_srism_between2lu': {19: 1}, 'f_count_ok_ul_between2lu': {19: 1}, 'f_count_ok_ulgprs_between2lu': {19: 0}, 'f_count_ok_ussd_between2lu': {19: 3}, 'f_frequent_ok_cl_between2lu': {19: 0}, 'f_frequent_ok_psi_between2lu': {19: 1}, 'f_frequent_ok_dsd_between2lu': {19: 0}, 'f_frequent_ok_fwsm_mo_between2lu': {19: 1}, 'f_frequent_ok_fwsm_mt_between2lu': {19: 0}, 'f_frequent_ok_fwsm_report_between2lu': {19: 0}, 'f_frequent_ok_fwsm_submit_between2lu': {19: 0}, 'f_frequent_ok_isd_between2lu': {19: 0}, 'f_frequent_ok_prn_between2lu': {19: 0}, 'f_frequent_ok_purge_ms_between2lu': {19: 0}, 'f_frequent_ok_sai_between2lu': {19: 0}, 'f_frequent_ok_si_between2lu': {19: 0}, 'f_frequent_ok_sri_between2lu': {19: 0}, 'f_frequent_ok_srism_between2lu': {19: 0}, 'f_frequent_ok_ul_between2lu': {19: 0}, 'f_frequent_ok_ulgprs_between2lu': {19: 0}, 'f_frequent_ok_ussd_between2lu': {19: 0}, 'f_ratio_cl_psi': {19: 1.02}, 'f_high_activity_5min': {19: 1}, 'f_one_cggt_multi_cdgt_psi': {19: nan}}
2025-05-22 14:22:51,006 - INFO - IP de origen detectada: 172.16.128.51
2025-05-22 14:22:51,030 - INFO - Predicción realizada - Riesgo: 3.39%
2025-05-22 14:22:51,036 - INFO - Intentando bloquear IP: 172.16.128.51
2025-05-22 14:22:51,054 - INFO - IP bloqueada exitosamente: 172.16.128.51
2025-05-22 14:24:55,908 - INFO - Modelo cargado correctamente desde: /home/evelym/Lab/VelyFirewall/scripts/models/7ef258d0e7dd4ef68d08688c4a903728_XGB_model.joblib
2025-05-22 14:24:55,908 - INFO - El modelo espera 45 características: [np.str_('f_c_ossn_others'), np.str_('f_same_cggt_is_gmlc_oc'), np.str_('f_same_cggt_is_gmlc_ossn'), np.str_('f_same_cggt_is_hlr_oc'), np.str_('f_same_cggt_is_hlr_ossn'), np.str_('f_count_ok_cl_between2lu'), np.str_('f_count_ok_psi_between2lu'), np.str_('f_velocity_greater_than_1000'), np.str_('f_count_unloop_country_last_x_hours_ul'), np.str_('f_count_gap_ok_sai_and_all_lu'), np.str_('f_count_ok_dsd_between2lu'), np.str_('f_count_ok_fwsm_mo_between2lu'), np.str_('f_count_ok_fwsm_mt_between2lu'), np.str_('f_count_ok_fwsm_report_between2lu'), np.str_('f_count_ok_fwsm_submit_between2lu'), np.str_('f_count_ok_isd_between2lu'), np.str_('f_count_ok_prn_between2lu'), np.str_('f_count_ok_purge_ms_between2lu'), np.str_('f_count_ok_sai_between2lu'), np.str_('f_count_ok_si_between2lu'), np.str_('f_count_ok_sri_between2lu'), np.str_('f_count_ok_srism_between2lu'), np.str_('f_count_ok_ul_between2lu'), np.str_('f_count_ok_ulgprs_between2lu'), np.str_('f_count_ok_ussd_between2lu'), np.str_('f_frequent_ok_cl_between2lu'), np.str_('f_frequent_ok_psi_between2lu'), np.str_('f_frequent_ok_dsd_between2lu'), np.str_('f_frequent_ok_fwsm_mo_between2lu'), np.str_('f_frequent_ok_fwsm_mt_between2lu'), np.str_('f_frequent_ok_fwsm_report_between2lu'), np.str_('f_frequent_ok_fwsm_submit_between2lu'), np.str_('f_frequent_ok_isd_between2lu'), np.str_('f_frequent_ok_prn_between2lu'), np.str_('f_frequent_ok_purge_ms_between2lu'), np.str_('f_frequent_ok_sai_between2lu'), np.str_('f_frequent_ok_si_between2lu'), np.str_('f_frequent_ok_sri_between2lu'), np.str_('f_frequent_ok_srism_between2lu'), np.str_('f_frequent_ok_ul_between2lu'), np.str_('f_frequent_ok_ulgprs_between2lu'), np.str_('f_frequent_ok_ussd_between2lu'), np.str_('f_ratio_cl_psi'), np.str_('f_high_activity_5min'), np.str_('f_one_cggt_multi_cdgt_psi')]
2025-05-22 14:25:40,273 - INFO - Procesando archivo: /home/evelym/Lab/VelyFirewall/logs/20250522_1425_ss7_traffic_20250522_142504.csv
2025-05-22 14:25:40,290 - INFO - Datos a procesar: {'src_ip': {11: '172.16.128.154'}, '_time': {11: '2025-05-22 14:25:16'}, 'c_timestamp': {11: '2025-05-22 14:25:16'}, 'c_cggt': {11: 'CGGT_1017'}, 'c_imsi': {11: 756604003709045}, 'f_c_ossn_others': {11: nan}, 'f_same_cggt_is_gmlc_oc': {11: 0}, 'f_same_cggt_is_gmlc_ossn': {11: 0}, 'f_same_cggt_is_hlr_oc': {11: 1}, 'f_same_cggt_is_hlr_ossn': {11: 0}, 'f_count_ok_cl_between2lu': {11: 4}, 'f_count_ok_psi_between2lu': {11: 2}, 'f_velocity_greater_than_1000': {11: 0}, 'f_count_unloop_country_last_x_hours_ul': {11: nan}, 'f_count_gap_ok_sai_and_all_lu': {11: nan}, 'f_count_ok_dsd_between2lu': {11: 2}, 'f_count_ok_fwsm_mo_between2lu': {11: 0}, 'f_count_ok_fwsm_mt_between2lu': {11: 0}, 'f_count_ok_fwsm_report_between2lu': {11: 3}, 'f_count_ok_fwsm_submit_between2lu': {11: 0}, 'f_count_ok_isd_between2lu': {11: 0}, 'f_count_ok_prn_between2lu': {11: 4}, 'f_count_ok_purge_ms_between2lu': {11: 2}, 'f_count_ok_sai_between2lu': {11: 0}, 'f_count_ok_si_between2lu': {11: 1}, 'f_count_ok_sri_between2lu': {11: 2}, 'f_count_ok_srism_between2lu': {11: 2}, 'f_count_ok_ul_between2lu': {11: 2}, 'f_count_ok_ulgprs_between2lu': {11: 2}, 'f_count_ok_ussd_between2lu': {11: 5}, 'f_frequent_ok_cl_between2lu': {11: 0}, 'f_frequent_ok_psi_between2lu': {11: 0}, 'f_frequent_ok_dsd_between2lu': {11: 0}, 'f_frequent_ok_fwsm_mo_between2lu': {11: 0}, 'f_frequent_ok_fwsm_mt_between2lu': {11: 0}, 'f_frequent_ok_fwsm_report_between2lu': {11: 0}, 'f_frequent_ok_fwsm_submit_between2lu': {11: 0}, 'f_frequent_ok_isd_between2lu': {11: 0}, 'f_frequent_ok_prn_between2lu': {11: 0}, 'f_frequent_ok_purge_ms_between2lu': {11: 0}, 'f_frequent_ok_sai_between2lu': {11: 0}, 'f_frequent_ok_si_between2lu': {11: 0}, 'f_frequent_ok_sri_between2lu': {11: 0}, 'f_frequent_ok_srism_between2lu': {11: 0}, 'f_frequent_ok_ul_between2lu': {11: 0}, 'f_frequent_ok_ulgprs_between2lu': {11: 0}, 'f_frequent_ok_ussd_between2lu': {11: 0}, 'f_ratio_cl_psi': {11: 1.74}, 'f_high_activity_5min': {11: 0}, 'f_one_cggt_multi_cdgt_psi': {11: nan}}
2025-05-22 14:25:40,291 - INFO - IP de origen detectada: 172.16.128.154
2025-05-22 14:25:40,319 - INFO - Predicción realizada - Riesgo: 0.23%
